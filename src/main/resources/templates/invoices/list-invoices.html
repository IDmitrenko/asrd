<!DOCTYPE html>
<!--suppress ThymeleafVariablesResolveInspection -->
<html xmlns:th="http://www.thymeleaf.org" lang="ru">

<head th:replace="layouts :: header"></head>

<body>

<nav th:replace="layouts :: navbar(Invoices)"></nav>

<div class="container-fluid">
    <br>
    <h1>Каталог накладных</h1>
    <hr>

    <a th:href="@{/invoices/0/update}"
       class="btn btn-primary btn-sm mb-3">
        Добавить
    </a>

    <div class="row flex-xl-nowrap">
        <div class="col-12 col-lg-3 bd-sidebar">
            <form class="d-flex flex-column">
                <div class="d-flex flex-row">
                    <div class="col-6">
                        <div class="form-group">
                            <label for="entityStatus">Статус:</label>
                            <select class="form-control form-control-sm" id="entityStatus" name="entityStatus">
                                <option th:text="'Не выбрано'" th:value="null"></option>
                                <option th:each="status : ${T(com.kropotov.asrd.entities.enums.Status).values()}"
                                        th:value="${status.ordinal()}" th:text="${status.name}"
                                        th:selected="${#request.getParameter('entityStatus')==status.ordinal().toString()}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="system">Система:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="system" name="system" th:value="${#request.getParameter('system')}">
                        </div>
                        <div class="form-group">
                            <label for="device">Прибор:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="device" name="device" th:value="${#request.getParameter('device')}">
                        </div>
                        <hr>

                        <div class="form-group">
                            <label for="createdAtFrom">Создан после:</label>
                            <input type="datetime-local" class="form-control form-control-sm"
                                   id="createdAtFrom" name="createdAtFrom"
                                   th:value="${#request.getParameter('createdAtFrom')}">
                        </div>
                        <div class="form-group">
                            <label for="createdAtTo">Создан до:</label>
                            <input type="datetime-local" class="form-control form-control-sm"
                                   id="createdAtTo" name="createdAtTo"
                                   th:value="${#request.getParameter('createdAtTo')}">
                        </div>
                        <hr>

                        <div class="form-group">
                            <label for="companyFrom">Из компании:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="companyFrom" name="companyFrom" th:value="${#request.getParameter('companyFrom')}">
                        </div>
                        <div class="form-group">
                            <label for="companyDest">В компанию:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="companyDest" name="companyDest" th:value="${#request.getParameter('companyDest')}">
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="form-group">
                            <label for="invoiceDateFrom">Дата док-та после:</label>
                            <input type="date" class="form-control form-control-sm"
                                   id="invoiceDateFrom" name="invoiceDateFrom"
                                   th:value="${#request.getParameter('invoiceDateFrom')}">
                        </div>
                        <div class="form-group">
                            <label for="invoiceDateTo">Дата док-та до:</label>
                            <input type="date" class="form-control form-control-sm"
                                   id="invoiceDateTo" name="invoiceDateTo"
                                   th:value="${#request.getParameter('invoiceDateTo')}">
                        </div>
                        <hr>

                        <div class="form-group">
                            <label for="number">Номер:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="number" name="number" th:value="${#request.getParameter('number')}">
                        </div>
                        <hr>

                        <div class="form-group">
                            <label for="updatedAtFrom">Изменён после:</label>
                            <input type="datetime-local" class="form-control form-control-sm"
                                   id="updatedAtFrom" name="updatedAtFrom"
                                   th:value="${#request.getParameter('updatedAtFrom')}">
                        </div>
                        <div class="form-group">
                            <label for="updatedAtTo">Изменён до:</label>
                            <input type="datetime-local" class="form-control form-control-sm"
                                   id="updatedAtTo" name="updatedAtTo"
                                   th:value="${#request.getParameter('updatedAtTo')}">
                        </div>
                        <hr>

                        <div class="form-group">
                            <label for="userName">Username:</label>
                            <input type="text" class="form-control form-control-sm"
                                   id="userName" name="userName"
                                   th:value="${#request.getParameter('userName')}">
                        </div>
                    </div>
                </div>
                <button class="btn btn-sm btn-primary" type="submit">применить</button>
            </form>
        </div>

        <span class="d-flex justify-content-center" th:if="${page.items.size() == 0}" th:text="'Накладных нет'"></span>

        <div class="col-12 col-lg-9" th:unless="${page.items.size() == 0}">
            <table class="table table-hover mr-3">
                <thead class="thead-dark">
                <tr>
                    <th>№ п/п</th>
                    <th>
                        Номер
                        <span th:replace="~{layouts :: sortButtons(number)}"></span>
                    </th>
                    <th>
                        Дата
                        <span th:replace="~{layouts :: sortButtons(date)}"></span>
                    </th>
                    <th>
                        Файл
                        <span th:replace="~{layouts :: sortButtons(path)}"></span>
                    </th>
                    <th>
                        Отправитель
                        <span th:replace="~{layouts :: sortButtons(from)}"></span>
                    </th>
                    <th>
                        Получатель
                        <span th:replace="~{layouts :: sortButtons(destination)}"></span>
                    </th>
                    <th class="wide-column">
                        Описание
                    </th>
                </tr>
                </thead>
                <tbody>
                <!--        th:onclick="'window.location.href=\'invoices/' + ${invoice.id} + '\'; return false'"-->
                <tr th:each="invoice, i : ${page.content}" th:attr="sys_id=${invoice.id}">
                    <td th:text="${(page.number - 1) * page.size + i.count}"></td>
                    <td>
                        <a href="#" th:href="@{'/invoices/' + ${invoice.id} + '/show'}" th:text="${invoice.number}"></a>
                    </td>
                    <td th:text="${invoice.date}"></td>
                    <td>
                        <a th:href="@{'/files/invoices/' + ${invoice.path}}" th:text="${invoice.path}"
                           target="_blank"></a>
                    </td>
                    <td th:text="${invoice.from.getTitle()}"></td>
                    <td th:text="${invoice.destination.getTitle()}"></td>
                    <td th:text="${invoice.description}"></td>
                </tr>
                </tbody>
            </table>

            <div class="d-flex justify-content-end">
                <nav th:replace="layouts :: pagination"></nav>
            </div>
        </div>
    </div>
</div>
<div th:replace="layouts :: footer"></div>
</body>
</html>
